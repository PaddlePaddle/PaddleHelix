# LiteGEM: Solution to PCQM4M-LSC of KDD Cup 2021

* Please refer to our **[techical report](./SuperHelix_PCQM4M.pdf)** for the details of implementation and performance.

## Installation requirements
```
ogb==1.3.0
rdkit>=2019.03.1
torch>=1.7.0
paddlepaddle-gpu>=2.1.0
pgl>=2.1.4
```

## Data preparation
Under the root directory, please run following command to downlaod the pretrain and pcqm4m datasets.
```
mkdir dataset && cd dataset
wget http://ogb-data.stanford.edu/data/lsc/pcqm4m_kddcup2021.zip
unzip pcqm4m_kddcup2021.zip
cd ..
```

## Directory structure
```
|-- ogbg_lsc
    |-- README.md
    |-- src             # scripts
    |-- models          # model definition
    |-- utils
    |-- outputs         # model predictions (generated by training)
    |-- dataset         # the original dataset and customed splits 
    |-- checkpoints     # model checkpoints (generated by training)
    |-- ensemble        # submitted predictions and code for ensemble
    |-- logs            # train logs (generated by training)
 ```

## Configuration

Model hyper-parameters and other arguments are all defined in `./src/config.yaml`.

## Model training

The whole training/ensemble pipeline is defined in `./src/main.sh`. Start default training with 2-fold cross validation:

```
cd ./src
sh main.sh 0 1     # "0 1" defines the CUDA devices
```

Barely train the model with original validation set:

```
cd ./src
export CUDA_VISIBLE_DEVICES=0
python main.py --config config.yaml
```

## Performance

| Model            | Test MAE | \#Parameters |           Hardware          |
|------------------|:--------:|:------------:|:---------------------------:|
| LiteGEM          |  0.1204  |      74M     | Nvidia Tesla P40 (24GB GPU) |
| GIN*             |  0.1678  |     3.8M     | GeForce RTX 2080 (11GB GPU) |
| GIN-virtual*     |  0.1487  |     6.7M     | GeForce RTX 2080 (11GB GPU) |
| GCN*             |  0.1838  |     2.0M     | GeForce RTX 2080 (11GB GPU) |
| GCN-virtual*     |  0.1579  |     4.9M     | GeForce RTX 2080 (11GB GPU) |
| MLP+Fingerprint* |  0.2068  |     16.1M    | GeForce RTX 2080 (11GB GPU) |

\* Results copied from the [baseline performance for PCQM4M-LSC](https://github.com/snap-stanford/ogb/blob/master/examples/lsc/pcqm4m/README.md#performance).
